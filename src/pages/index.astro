---
import Layout from '../layouts/Layout.astro';
import ExitIntentPopup from '@/components/ExitIntentPopup.astro';
import MobileStickyBuy from '@/components/MobileStickyBuy.astro';
import {
  Section,
  SectionHeader,
  Button,
  Badge,
  ComingSoonCard,
  Card,
  CardHeader,
  CardTitle,
  CardContent,
  HeroCarousel,
  TestimonialCarousel,
  NewsletterSection,
  BookSeriesCard,
} from '@/components/ui';
import {
  FEATURED_BOOK,
  getSeriesById,
  getBooksBySeriesId,
  getAmazonUrl,
  HERO_SLIDES,
  TESTIMONIALS,
  COMING_SOON_PRODUCTS,
  AVAILABLE_PRODUCTS,
} from '@/data/products';
import { getOptimizedImage } from '@/lib/images';

// Use centralized data
const featuredBook = FEATURED_BOOK;
const featuredSeries = getSeriesById('marvelous-hindu-deities')!;
const featuredBooks = getBooksBySeriesId('marvelous-hindu-deities');
const heroSlides = HERO_SLIDES;
const testimonials = TESTIMONIALS;
const comingProducts = COMING_SOON_PRODUCTS;
const availableProducts = AVAILABLE_PRODUCTS;

// Optimized OG image
const ogImage = getOptimizedImage(featuredBook.image, 'hero');
---

<Layout
  title="Hindu Children's Books — Mythology, Shlokas & Mantras for Kids | Roots On Rise"
  description="Shop Hindu mythology books for kids featuring Ganesha, Krishna & Lakshmi. Shloka and mantra books with Sanskrit pronunciation guides. Board books, paperbacks & Kindle. Perfect Diwali gifts ages 2-14."
  image={ogImage}
>
  <!-- Hero: Static first slide for instant LCP, carousel enhances when idle -->
  <section class="relative w-full overflow-hidden bg-dark">
    <!-- Static first slide — paints immediately, no JS needed -->
    <div id="hero-static" class="relative h-[70vh] md:h-[85vh] w-full">
      <div class="absolute inset-0 overflow-hidden">
        <img
          src={getOptimizedImage(heroSlides[0].image, 'hero')}
          alt=""
          class="absolute inset-0 w-full h-full object-cover"
          fetchpriority="high"
          loading="eager"
          decoding="sync"
          width="1200"
          height="800"
        />
      </div>
      <div class="absolute inset-0 bg-gradient-to-r from-dark/90 via-dark/50 to-dark/20" aria-hidden="true"></div>
      <div class="absolute inset-0 bg-gradient-to-t from-dark/60 via-transparent to-transparent" aria-hidden="true"></div>
      <div class="absolute inset-0 flex items-center">
        <div class="w-full px-6 md:px-12 lg:px-16 xl:px-20">
          <div class="max-w-7xl mx-auto">
            {heroSlides[0].badge && (
              <span class="inline-block bg-primary/90 text-light text-sm font-semibold px-4 py-1.5 rounded-full mb-4 md:mb-5">
                {heroSlides[0].badge}
              </span>
            )}
            <h2 class="font-title font-bold text-3xl md:text-5xl lg:text-6xl text-light mb-4 md:mb-6 tracking-tight leading-[1.1]">
              {heroSlides[0].title}
            </h2>
            {heroSlides[0].description && (
              <p class="text-light/80 text-lg md:text-xl mb-6 md:mb-8 max-w-xl leading-relaxed">
                {heroSlides[0].description}
              </p>
            )}
            {heroSlides[0].ctaText && heroSlides[0].ctaLink && (
              <a
                href={heroSlides[0].ctaLink}
                class="inline-flex items-center gap-2 px-8 py-4 rounded-full bg-primary hover:bg-primary-dark text-light font-semibold text-lg transition-all duration-300 ease-out hover:scale-105 hover:shadow-2xl hover:shadow-primary/30"
              >
                {heroSlides[0].ctaText}
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
              </a>
            )}
          </div>
        </div>
      </div>
    </div>
    <!-- Interactive carousel overlays static content when JS is idle -->
    <div class="absolute inset-0 z-10">
      <HeroCarousel
        slides={heroSlides}
        autoRotate={true}
        interval={6000}
        client:idle
      />
    </div>
  </section>

  <!-- Featured Book Section -->
  <Section background="light">
    <SectionHeader
      title="bestselling book"
      highlight="bestselling"
      description={'Join thousands of families who have made "The Marvelous Hindu Deities" part of their bedtime story collection.'}
    />

    <BookSeriesCard
      series={featuredSeries}
      books={featuredBooks}
      defaultFormat="board-book"
      client:load
    />
  </Section>

  <!-- Mission Highlight -->
  <Section background="tertiary" container="md">
    <div class="text-center">
      <h2 class="font-title font-bold text-3xl md:text-4xl text-dark mb-6">
        <span class="text-primary">our</span> mission
      </h2>
      <p class="text-dark/80 text-lg md:text-xl leading-relaxed mb-8">
        At Roots On Rise, we spark curiosity and cultivate a deep connection to culture, heritage, and history through engaging, immersive experiences that help people of all ages explore their roots and foster a sense of identity and belonging.
      </p>
      <Button variant="outline" asChild>
        <a href="/about">Learn About Us</a>
      </Button>
    </div>
  </Section>

  <!-- Testimonials Carousel -->
  <Section>
    <SectionHeader
      title="loved by families"
      highlight="loved"
      description="See what parents are saying about our books."
    />
    <TestimonialCarousel
      testimonials={testimonials}
      autoRotate={true}
      interval={5000}
      client:load
    />
  </Section>

  <!-- Available Now -->
  <Section background="light">
    <SectionHeader
      title="available now"
      highlight="available"
      description="Check out our free digital downloads!"
    />
    <div class="grid md:grid-cols-3 gap-8">
      {availableProducts.map((product) => (
        <a href={product.href} class="block group">
          <Card className="overflow-hidden hover:shadow-lg transition-shadow h-full">
            <div class="aspect-square relative overflow-hidden">
              <img
                src={product.image}
                alt={product.title}
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
              {product.badge && (
                <Badge variant="free" className="absolute top-3 right-3">
                  {product.badge}
                </Badge>
              )}
            </div>
            <CardHeader>
              <CardTitle>{product.title}</CardTitle>
            </CardHeader>
            <CardContent className="pt-0">
              <p class="text-dark/60 text-sm">{product.description}</p>
            </CardContent>
          </Card>
        </a>
      ))}
    </div>
  </Section>

  <!-- Coming Soon Products -->
  <Section>
    <SectionHeader
      title="coming soon"
      highlight="coming"
      description="We're expanding our collection with more products celebrating Hindu heritage."
    />
    <div class="grid md:grid-cols-2 gap-8">
      {comingProducts.map((product) => (
        <a href={product.href} class="block">
          <ComingSoonCard
            title={product.title}
            description={product.description}
            image={product.image}
          />
        </a>
      ))}
    </div>
  </Section>

  <!-- Newsletter Section -->
  <NewsletterSection
    title="Join our community"
    highlight="community"
    description="Get notified about new books, free resources, and cultural celebration ideas."
    variant="tertiary"
    client:load
  />

  <!-- Final CTA -->
  <Section background="dark" container="md">
    <div class="text-center">
      <h2 class="font-title font-bold text-2xl md:text-3xl text-light mb-4">
        Start your <span class="text-primary">cultural journey</span> today
      </h2>
      <p class="text-light/70 max-w-xl mx-auto mb-3">
        Give your children the gift of understanding their rich heritage through beautifully illustrated stories.
      </p>
      <div class="flex items-center justify-center gap-2 mb-8">
        <span class="text-amber-400 text-sm">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
        <span class="text-light/50 text-xs">Loved by families worldwide</span>
      </div>
      <div class="flex flex-wrap gap-4 justify-center">
        <Button variant="amazon" size="lg" asChild>
          <a href={getAmazonUrl('8195870724')} target="_blank" rel="noopener">
            Get It With Free Prime Delivery
          </a>
        </Button>
        <Button variant="outlineLight" size="lg" asChild>
          <a href="/our-story">Read Our Story</a>
        </Button>
      </div>
    </div>
  </Section>

  <!-- Conversion Components -->
  <ExitIntentPopup />
  <MobileStickyBuy />
</Layout>
